<div class="registro-incidentes">
  <h2>Registro de Incidentes</h2>
  <!-- Registar incidentes -->
  <!-- Formulario de Incidentes -->
  <!--  -->
  <form [formGroup]="incidenteForm" (ngSubmit)="submitForm()">
    <div class="form-group">
      <label for="Id_Areas_Servicios">Área de Servicio *</label>
      <select id="Id_Areas_Servicios" class="form-control" formControlName="Id_Areas_Servicios">
        <option *ngFor="let areaServ of AreaServicio" [value]="areaServ.Id_Areas_Servicios">{{areaServ.Descripcion}}
        </option>
      </select>
      <div *ngIf="
          incidenteForm.get('Areas_Servicios')?.invalid &&
          incidenteForm.get('Areas_Servicios')?.touched
        " class="error">
        El área de servicio es obligatoria.
      </div>
    </div>

    <div class="form-group">
      <label for="Id_Tipos_Incidentes">Tipo de Incidente *</label>
      <select id="Id_Tipos_Incidentes" class="form-control" formControlName="Id_Tipos_Incidentes">
        <option *ngFor="let tincidente of TiposIncidentes" [value]="tincidente.Id_Tipos_Incidentes">
          {{tincidente.Descripcion}}
        </option>
      </select>
      <div *ngIf="
          incidenteForm.get('Tipos_Incidentes')?.invalid &&
          incidenteForm.get('Tipos_Incidentes')?.touched
        " class="error">
        El tipo de incidente es obligatorio.
      </div>
    </div>

    <div class="form-group">
      <label for="Id_Prioridad">Prioridad *</label>
      <select id="Id_Prioridad" class="form-control" formControlName="Id_Prioridad">
        <option *ngFor="let prioridad of Prioridad" [value]="prioridad.Id_Prioridad">{{prioridad.Gravedad}}</option>
      </select>

      <!-- <td> {{ obtenerDescripcionAreaServicio(incidente.Id_Areas_Servicios) }} </td> -->
      <div *ngIf="
          incidenteForm.get('Prioridad')?.invalid &&
          incidenteForm.get('Prioridad')?.touched
        " class="error">
        El tipo de incidente es obligatorio.
      </div>
    </div>

    <div class="form-group">
      <label for="Id_Origen">Origen *</label>
      <select id="Id_Origen" class="form-control" formControlName="Id_Origen">
        <option *ngFor="let orig of Origen" [value]="orig.Id_Origen">{{orig.Descripcion}}</option>
      </select>
      <div *ngIf="
          incidenteForm.get('Origen')?.invalid &&
          incidenteForm.get('Origen')?.touched
        " class="error">
        El tipo de incidente es obligatorio.
      </div>
    </div>
    

    <div class="form-group">
      <label for="Observaciones">Observaciones</label>
      <input id="Observaciones" class="form-control" formControlName="Observaciones" type="text">
      <div *ngIf="
          incidenteForm.get('Observaciones')?.invalid &&
          incidenteForm.get('Observaciones')?.touched
        " class="error">
        La fecha y hora es obligatoria.
      </div>
    </div>


      <h2>Datos del Ciudadano</h2>

      <!-- Formulario de Ciudadano  -->
      <div class="form-group">
        <label for="Dni">DNI *</label>
        <input type="text" id="Dni" class="form-control" formControlName="Dni" placeholder="Ingrese el DNI" />
        <!-- (click)="buscarCiudadano()"  -->
        <button type="button" class="buscar-btn">
          Buscar
        </button>
        <div *ngIf="
            incidenteForm.get('Dni')?.invalid &&
            incidenteForm.get('Dni')?.touched
          " class="error">
          El DNI es obligatorio y debe tener 8 dígitos.
        </div>
      </div>

      <div class="form-group">
        <label for="Apellido">Apellido*</label>
        <input type="text" id="Apellido" class="form-control" formControlName="Apellido"
          placeholder="Ingrese Apellido" />
        <div *ngIf="
            incidenteForm.get('Apellido')?.invalid &&
            incidenteForm.get('Apellido')?.touched
          " class="error">
          El Apellido es obligatorio.
        </div>
      </div>

      <div class="form-group">
        <label for="Nombre">Nombre *</label>
        <input type="text" id="Nombre" class="form-control" formControlName="Nombre" placeholder="Ingrese Nombre" />
        <div *ngIf="
            incidenteForm.get('Nombre')?.invalid &&
            incidenteForm.get('Nombre')?.touched
          " class="error">
          El Nombre son obligatorios.
        </div>
      </div>


      <div class="form-group">
        <label for="sexo">Sexo *</label>
        <select id="sexo" class="form-control" formControlName="sexo">
          <option value="femenino">Femenino</option>
          <option value="Masculino">Masculino</option>
          <option value="Otro">Otro</option>
        </select>
        <div *ngIf="
            incidenteForm.get('sexo')?.invalid &&
            incidenteForm.get('sexo')?.touched
          " class="error">
          El Sexo son obligatorios.
        </div>
      </div>

      <div class="form-group">
        <label for="Domicilio">Domicilio</label>
        <input type="text" id="Domicilio" class="form-control" formControlName="Domicilio" />
        <div *ngIf="
        incidenteForm.get('Domicilio')?.invalid &&
        incidenteForm.get('Domicilio')?.touched
      " class="error">
          El Domicilio son obligatorios.
        </div>
      </div>

      <div class="form-group">
        <label for="Barrio">Barrio</label>
        <select id="Barrio" class="form-control" formControlName="Barrio">
          <option value="Seleccione un barrio">Seleccione un barrio</option>
          <option value="Don Bosco">Don Bosco</option>
          <option value="Luis Piedra Buena">Luis Piedra Buena</option>
          <option value="Alta Barda">Alta Barda</option>
        </select>
        <div *ngIf="
        incidenteForm.get('Barrio')?.invalid &&
        incidenteForm.get('Barrio')?.touched" class="error">
          El Barrio son obligatorios.
        </div>
      </div>

      <div class="form-group">
        <label for="Telefono">Teléfono</label>
        <input type="text" id="Telefono" class="form-control" formControlName="Telefono"
          placeholder="Ingrese teléfono sin 0 ni 15" />
        <div *ngIf="
          incidenteForm.get('Telefono')?.invalid &&
          incidenteForm.get('Telefono')?.touched
        " class="error">
          El teléfono debe tener 10 dígitos.
        </div>
      </div>

      <div class="form-group">
        <label for="email">E-mail</label>
        <input type="email" id="email" class="form-control" formControlName="email" placeholder="Ingrese E-mail" />
        <div *ngIf="
          incidenteForm.get('email')?.invalid &&
          incidenteForm.get('email')?.touched" class="error">
          El formato del email no es válido.
        </div>
      </div>
    <!-- </div> -->


    <button type="submit" [disabled]="incidenteForm.invalid"> Registrar Incidente </button>
  </form>

  <div class="table-container">
    <table class="styled-table">
      <thead>
        <tr>
          <th>Id Incidente</th>
          <th>Fecha y hora</th>
          <!-- <th>Otros Datos</th> -->
          <th>Observaciones</th>
          <th>Id Areas Servicio</th>
          <th>Id_Tipos_Incidentes</th>
          <th>Id_Prioridad</th>
          <th>Id_Origen</th>
          <th>Id_Ciudadanos</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let incidente of incidentes">
          <td>{{incidente.Id_Incidentes}}</td>
          <td>{{incidente.Fecha_Hora}}</td>
          <!-- <td>{{incidente.Otros_Datos}}</td> -->
          <td>{{incidente.Observaciones}}</td>
          <td> {{ obtenerDescripcionAreaServicio(incidente.Id_Areas_Servicios) }} </td>
          <td> {{ obtenerDescripcionTiposIncidentes(incidente.Id_Tipos_Incidentes) }} </td>
          <td> {{ obtenerDescripcionPrioridad(incidente.Id_Prioridad) }} </td>
          <td> {{ obtenerDescripcionOrigen(incidente.Id_Origen) }} </td>
          <td> {{ obtenerDescripcionCiudadanos(incidente.Id_Ciudadanos) }} </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<!-- Formulario modificarIncidente -->

<!--<form *ngIF="incidenteSeleccionado" [formGroup]="modificarIncidenteForm" (ngSubmit)="registrarIncidente()">
      <div class="form-group">
        <label for="areaServicio">Área de Servicio *</label>
        <select id="areaServicio" class="form-control" formControlName="areaServicio">
          <option value="">Seleccione un área</option>
          <option value="">147</option>
          <option value="">a12</option>
        </select>
        <div *ngIf="incidenteForm.get('areaServicio')?.invalid && incidenteForm.get('areaServicio')?.touched" class="error">
          El área de servicio es obligatoria.
        </div>
      </div>
  
      <div class="form-group">
        <label for="tipoIncidente">Tipo de Incidente *</label>
        <select id="tipoIncidente" class="form-control" formControlName="tipoIncidente">
          <option value="">Seleccione un tipo</option>
          <option value="">Objeto en la via publica</option>
          <option value="">Protecion animal</option>
        </select>
        <div *ngIf="incidenteForm.get('tipoIncidente')?.invalid && incidenteForm.get('tipoIncidente')?.touched" class="error">
          El tipo de incidente es obligatorio.
        </div>
      </div>
  
      <div class="form-group">
        <label for="prioridad">Prioridad *</label>
        <select id="prioridad" class="form-control" formControlName="prioridad">
          <option value="baja">Baja</option>
          <option value="media">Media</option>
          <option value="alta">Alta</option>
          <option value="urgente">Urgente</option>
        </select>
      </div>
  
      <div class="form-group">
        <label for="origen">Origen *</label>
        <select id="origen" class="form-control" formControlName="origen">
          <option value="telefono">Teléfono Atención Vecino</option>
          <option value="email">Email</option>
        </select>
      </div>
  
      <div class="form-group">
        <label for="datetime">Fecha y hora *</label>
        <input type="datetime-local" id="datetime" class="form-control" formControlName="datetime">
        <div *ngIf="incidenteForm.get('datetime')?.invalid && incidenteForm.get('datetime')?.touched" class="error">
          La fecha y hora es obligatoria.
        </div>
      </div>
  
      <div class="form-group">
        <label for="observaciones">Observaciones</label>
        <textarea id="observaciones" class="form-control" formControlName="observaciones"></textarea>
      </div>
    </form>
    
    <form action="">
      <h2>Datos del Ciudadano</h2>
   -->